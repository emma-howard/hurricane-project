# -*- coding: utf-8 -*-
"""NABasin_Dataset_Preprocessing.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Xg67qoEsHxywsegqlr82dowPBuxLY4wv
"""

import pandas as pd

# Import data
# (from: https://www.ncei.noaa.gov/data/international-best-track-archive-for-climate-stewardship-ibtracs/v04r00/access/csv/)
data = pd.read_csv('ibtracs_NA_raw.csv')

# Columns to filter
print(len(data))
Wind_Speed = (data.WMO_WIND.str.strip() != "")
Wind_Pres = (data.WMO_PRES.str.strip() != "") 
Season = (data.SEASON > 1950)

# Filter the data
mask = Wind_Speed & Wind_Pres & Season
filtered_data = data[mask]

# Write filtered data to csv file
filtered_data.to_csv('ibtracs_NA_filtered.csv')

print(len(filtered_data))